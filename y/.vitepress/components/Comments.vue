<script setup>
import { ref, onMounted } from 'vue'
import { useRoute } from 'vitepress'

const route = useRoute()
const container = ref(null)

onMounted(() => {
  const script = document.createElement('script')
  script.src = 'https://giscus.app/client.js'
  script.setAttribute('data-repo', 'XSTATEM/Echips_Wiki')
  script.setAttribute('data-repo-id', 'R_kgDORTt3aQ')
  script.setAttribute('data-category', 'General')
  script.setAttribute('data-category-id', 'DIC_kwDORTt3ac4C22bF')
  script.setAttribute('data-mapping', 'pathname')
  script.setAttribute('data-strict', '0')
  script.setAttribute('data-reactions-enabled', '1')
  script.setAttribute('data-emit-metadata', '0')
  script.setAttribute('data-input-position', 'top')
  
  // –ú–µ–Ω—è–µ–º —Ç–µ–º—É –Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é! –¢–µ–ø–µ—Ä—å –æ–Ω–∞ —Å–∞–º–∞ –±—É–¥–µ—Ç —Å–≤–µ—Ç–ª–æ–π –∏–ª–∏ —Ç–µ–º–Ω–æ–π
  script.setAttribute('data-theme', 'preferred_color_scheme') 
  
  script.setAttribute('data-lang', 'ru')
  script.crossOrigin = 'anonymous'
  script.async = true
  
  container.value.appendChild(script)
})
</script>

<template>
  <div class="comments-wrapper" :key="route.path">
    <div class="comments-header">
      üí¨ –û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∞
    </div>
    <div ref="container" class="giscus-container"></div>
  </div>
</template>

<style scoped>
/* –ù–∞–≤–æ–¥–∏–º –∫—Ä–∞—Å–æ—Ç—É –Ω–∞ –±–ª–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ */
.comments-wrapper {
  margin-top: 60px;
  background-color: var(--vp-c-bg-soft); /* –ú—è–≥–∫–∏–π —Ñ–æ–Ω, –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Ç–µ–º—É VitePress */
  border-radius: 16px; /* –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã */
  padding: 30px;
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.04); /* –û—á–µ–Ω—å –ª–µ–≥–∫–∞—è "—ç–ø–ø–ª–æ–≤—Å–∫–∞—è" —Ç–µ–Ω—å */
  border: 1px solid var(--vp-c-divider); /* –¢–æ–Ω–∫–∞—è –∞–∫–∫—É—Ä–∞—Ç–Ω–∞—è —Ä–∞–º–∫–∞ */
}

.comments-header {
  font-size: 1.2rem;
  font-weight: 600;
  margin-bottom: 20px;
  color: var(--vp-c-text-1);
  display: flex;
  align-items: center;
  gap: 8px;
}

.giscus-container {
  min-height: 300px; /* –ß—Ç–æ–±—ã —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ "–ø—Ä—ã–≥–∞–ª–∞", –ø–æ–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≥—Ä—É–∑—è—Ç—Å—è */
}
</style>